<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. AXUI introduce &mdash; AXUI document 0.1.5 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="AXUI document 0.1.5 documentation" href="index.html" />
    <link rel="next" title="2. AXUI configurations" href="config_AXUI.html" />
    <link rel="prev" title="Welcome to AXUI document’s documentation!" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="config_AXUI.html" title="2. AXUI configurations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to AXUI document’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">AXUI document 0.1.5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="axui-introduce">
<span id="id1"></span><h1>1. AXUI introduce<a class="headerlink" href="#axui-introduce" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Page Status:</th><td class="field-body">Development</td>
</tr>
<tr class="field-even field"><th class="field-name">Last Reviewed:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="section" id="axui-philosophy">
<h2>1.1. AXUI philosophy<a class="headerlink" href="#axui-philosophy" title="Permalink to this headline">¶</a></h2>
<p>Due to varies of reasons, writing and maintaining UI automation is easy to turn into a time cost/unpleasant task,
and becomes hard to reach the predefined automation goal, and eventually UI automation is give up and leave people a bad impression</p>
<p>Let&#8217;s have a summary of these reasons:</p>
<ol class="arabic">
<li><p class="first">UI is hard for programming, UI is a good/direct interface for people, but not a good interface for programming. On the contrary, CLI is good for programming.
controlling UI is basically a inter process communication, typical step is:</p>
<ol class="arabic simple">
<li>find the target UI with some UI special features</li>
<li>control process/scripts send a request to UI</li>
<li>check for response/state</li>
</ol>
<p>Potential problems in upper steps:</p>
<ul class="simple">
<li>UI features used to find UI is not user friendly, some feature is not visible or have no meaning</li>
<li>UI control request is not user friendly, like a mouse/keyboard/touch event</li>
<li>UI could have lots of responses under different condition (UI change/no change/long time response/hang/crash), need to handle all of them</li>
</ul>
</li>
<li><p class="first">Tool support for UI automation is not easy to use, especially for PC platform due to there is a lot of UI frameworks on PC
mainly problems for varies UI automation tools:</p>
<ul class="simple">
<li>Different tool has different flavour of the programming language/style</li>
<li>Some tool is not powerful enough, but has no way to extend the function</li>
<li>There are a lot of tools, need good experience to select a proper tool to use</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are a lot of good tools emerging, like <a class="reference external" href="https://github.com/SeleniumHQ/selenium">selenium</a> for web test automation, <a class="reference external" href="https://github.com/appium">appium</a> for smartphone automation</p>
</div>
</li>
<li><p class="first">Testers are lack of programming skills to make test scripts robust and easy to maintain.
Testers are responsible for test design and test execution.
Thus, testers might not have enough coding skills to use complex libraries.
Automation tools should be easy for testers to use, let testers focus their energy to improve test cases</p>
</li>
</ol>
<p>AXUI is a collection of solutions for these problems:</p>
<ol class="arabic simple">
<li>AXUI provide a plug-in mechanism for automation guy to extend support for different UI</li>
<li>AXUI provide an unified, easy to use python interface for use in test scripts</li>
<li>AXUI separate UI logic from test scripts, make test scripts more readable and easier to maintain</li>
<li>AXUI provide mechanism to handle auto met UI automation issues, like UI response time</li>
</ol>
<p>To summarize, AXUI is to minimize the gap between testers and UI automation technologies.</p>
</div>
<div class="section" id="axui-structure">
<h2>1.2. AXUI structure<a class="headerlink" href="#axui-structure" title="Permalink to this headline">¶</a></h2>
<p>AXUI basically includes four modules,
XML module to parse <code class="docutils literal"><span class="pre">app</span> <span class="pre">map</span></code>,
driver module to manage different drivers,
interface module to provide testers an easy to use API,
core module provides basic functions used by other modules</p>
<a class="reference internal image-reference" href="_images/AXUI_structure.PNG"><img alt="_images/AXUI_structure.PNG" src="_images/AXUI_structure.PNG" /></a>
</div>
<div class="section" id="axui-technologies-details">
<h2>1.3. AXUI technologies details<a class="headerlink" href="#axui-technologies-details" title="Permalink to this headline">¶</a></h2>
<p>This section gives a brief introduce about some main features of AXUI</p>
<div class="section" id="separate-ui-logic-from-test-script">
<h3>1.3.1. separate UI logic from test script<a class="headerlink" href="#separate-ui-logic-from-test-script" title="Permalink to this headline">¶</a></h3>
<p>UI automation technologies often use a formatted string as identifier to find UI element,
test scripts could contain a lot of these strings, makes scripts harder to understand and maintain.
AXUI separate these strings to a standalone XML file, we usually create a XML file for one app, and thus we normally call this XML file an <code class="docutils literal"><span class="pre">app</span> <span class="pre">map</span></code>
An <code class="docutils literal"><span class="pre">app</span> <span class="pre">map</span></code> is just like a header file containing definitions, so scripts can reuse the definitions in <code class="docutils literal"><span class="pre">app</span> <span class="pre">map</span></code>, no need to  string in scripts.</p>
<p>Here is a sample <code class="docutils literal"><span class="pre">app</span> <span class="pre">map</span></code> for windows media player:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;AXUI:app_map xmlns:AXUI=&quot;AXUI&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;AXUI AXUI_app_map.xsd&quot;&gt;

    &lt;AXUI:funcs&gt;
        &lt;AXUI:func name=&quot;wmplayer_start&quot; description=&quot;&quot;&gt;
            &lt;AXUI:step type=&quot;CLI&quot; cmd=&#39;&quot;C:\Program Files\Windows Media Player\wmplayer.exe&quot;&#39;/&gt;
        &lt;/AXUI:func&gt;

        &lt;AXUI:func name=&quot;wmplayer_stop&quot; description=&quot;&quot;&gt;
            &lt;AXUI:step type=&quot;GUI&quot; cmd=&#39;wmplayer_Window.WindowPattern.Close&#39;/&gt;
        &lt;/AXUI:func&gt;

        &lt;AXUI:func name=&quot;wmplayer_ctrl_o&quot; description=&quot;&quot;&gt;
            &lt;AXUI:step type=&quot;GUI&quot; cmd=&quot;wmplayer_Window.keyboard.Input &#39;^o&#39;&quot; /&gt;
        &lt;/AXUI:func&gt;

        &lt;AXUI:func name=&quot;open_dialog_stop&quot; description=&quot;&quot;&gt;
            &lt;AXUI:step type=&quot;GUI&quot; cmd=&quot;wmplayer_Window.Open_Dialog.WindowPattern.Close&quot;/&gt;
        &lt;/AXUI:func&gt;
    &lt;/AXUI:funcs&gt;

    &lt;AXUI:UI_elements&gt;
        &lt;AXUI:Root_element name=&quot;desktop&quot;/&gt;

        &lt;AXUI:UI_element name=&quot;wmplayer_Window&quot; parent=&quot;desktop&quot; identifier=&quot;Name=&#39;Windows Media Player&#39; OR Name=&#39;Now Playing&#39; AND LocalizedControlType=&#39;window&#39;&quot; start_func=&quot;wmplayer_start&quot; stop_func=&quot;wmplayer_stop&quot;&gt;
            &lt;AXUI:UI_element name=&quot;Open_Dialog&quot; identifier=&quot;Name=&#39;Open&#39; AND LocalizedControlType=&#39;dialog&#39;&quot; start_func=&quot;wmplayer_ctrl_o&quot; stop_func=&quot;open_dialog_stop&quot;&gt;
                &lt;AXUI:UI_element name=&quot;FileName_ComboBox&quot; identifier=&quot;Name=&#39;File name:&#39; AND LocalizedControlType=&#39;combo box&#39;&quot;&gt;
                    &lt;AXUI:UI_element name=&quot;FileName_Edit&quot; identifier=&quot;Name=&#39;File name:&#39; AND LocalizedControlType=&#39;edit&#39;&quot;/&gt;
                &lt;/AXUI:UI_element&gt;
                &lt;AXUI:UI_element name=&quot;Open_Button&quot; identifier=&quot;Name=&#39;Open&#39; AND LocalizedControlType=&#39;button&#39; AND Index=2&quot;/&gt;
            &lt;/AXUI:UI_element&gt;
        &lt;/AXUI:UI_element&gt;
    &lt;/AXUI:UI_elements&gt;

&lt;/AXUI:app_map&gt;
</pre></div>
</div>
</div>
<div class="section" id="plug-in-mechanism-to-extend-support-for-different-ui">
<h3>1.3.2. plug-in mechanism to extend support for different UI<a class="headerlink" href="#plug-in-mechanism-to-extend-support-for-different-ui" title="Permalink to this headline">¶</a></h3>
<p>AXUI provide a plug-in mechanism to support extend other UI automation technologies to AXUI,
See <a class="reference internal" href="extend_AXUI.html#extend-axui"><em>Extend AXUI</em></a></p>
</div>
<div class="section" id="other-supports-for-ui-automation">
<h3>1.3.3. other supports for UI automation<a class="headerlink" href="#other-supports-for-ui-automation" title="Permalink to this headline">¶</a></h3>
<p>AXUI provide other functions may used in UI automation,</p>
<ul class="simple">
<li>timeout mechanism to handle UI response time</li>
<li>image compare for UI verification</li>
<li>screenshot for every UI operation</li>
<li>multiple languages support for internationalization (TODO, which means I will never do it :) )</li>
</ul>
</div>
</div>
<div class="section" id="axui-interface">
<h2>1.4. AXUI interface<a class="headerlink" href="#axui-interface" title="Permalink to this headline">¶</a></h2>
<p>AXUI restructure the original UI API into two parts, common operations like UI search is taken into AXUI internal, user should use <code class="docutils literal"><span class="pre">app</span> <span class="pre">map</span></code> to search UI element,
UI element specified operations like button invoke, set editor value is ported out directly, user can use original API to operate the UI element after UI element is found,
so AXUI can make code disciplined while not reducing the power of original API.</p>
<p>AXUI native API:</p>
<ul class="simple">
<li>for configuration, <code class="docutils literal"><span class="pre">AXUI.Config(config_file)</span></code>, also see <a class="reference internal" href="config_AXUI.html#config-axui"><em>AXUI configurations</em></a></li>
<li>for UIElement checking, <code class="docutils literal"><span class="pre">AXUI.assertIsValid(element,</span> <span class="pre">msg)</span></code>, also see <em class="xref std std-ref">valid AXUI element</em></li>
<li>for AppMap control, <code class="docutils literal"><span class="pre">AXUI.AppMap</span></code>, also see <a class="reference internal" href="AXUI_AppMap.html#axui-appmap"><em>AXUI AppMap</em></a></li>
</ul>
<p>Driver special API, mostly AXUI keep original API, for detail usage, you could refer original API documents:</p>
<ul class="simple">
<li>for windows, check <a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/ee684021(v=vs.85).aspx">windows native UIAutomation Client API</a></li>
<li>for selenium, check <a class="reference external" href="https://github.com/SeleniumHQ/selenium">selenium project</a></li>
<li>for appnium, check <a class="reference external" href="https://github.com/appium/appium">appium project</a></li>
</ul>
</div>
<div class="section" id="a-simple-example">
<h2>1.5. a simple example<a class="headerlink" href="#a-simple-example" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s have a simple demo about how to control wmplayer to playback some media file on one 32bit windows machine:</p>
<ol class="arabic simple">
<li>Environment prepare</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>First to use AXUI, you need install python environment, prefer python 2.7 (TODO, support python 3 :) )</li>
<li>Install AXUI</li>
<li>Install <code class="docutils literal"><span class="pre">comtypes</span></code> as windows driver needs this library</li>
</ul>
</div></blockquote>
<ol class="arabic" start="2">
<li><p class="first">Write a appmap, like upper example, also see <a class="reference internal" href="AXUI_AppMap.html#axui-appmap"><em>AXUI AppMap</em></a></p>
</li>
<li><p class="first">Write a config file, usually you can modify the default config file, also see <a class="reference internal" href="config_AXUI.html#config-axui"><em>AXUI configurations</em></a></p>
</li>
<li><p class="first">Write a script like below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">###########################################################</span>
<span class="c">#prepare part</span>
<span class="c">###########################################################</span>
<span class="kn">import</span> <span class="nn">AXUI</span>

<span class="n">config_file</span> <span class="o">=</span> <span class="s">&quot;windows.cfg&quot;</span>             <span class="c">#config file name, abs path needed</span>
<span class="n">app_map</span> <span class="o">=</span> <span class="s">&quot;windows_media_player.xml&quot;</span>    <span class="c">#app map name, just need a file name, path not needed</span>

<span class="n">AXUI</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>                <span class="c">#load the config file</span>
<span class="n">appmap</span> <span class="o">=</span> <span class="n">AXUI</span><span class="o">.</span><span class="n">AppMap</span><span class="p">(</span><span class="n">app_map</span><span class="p">)</span>           <span class="c">#load the appmap</span>

<span class="c">############################################################</span>
<span class="c">#action part, now you can do the UI actions, here we open a media file</span>
<span class="c">############################################################</span>
<span class="n">media_file</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>                         <span class="c">#your media file need to open</span>

<span class="c">#set the media file path to wmplayer open dialog file name edit</span>
<span class="n">appmap</span><span class="o">.</span><span class="n">wmplayer_Window</span><span class="o">.</span><span class="n">Open_Dialog</span><span class="o">.</span><span class="n">FileName_ComboBox</span><span class="o">.</span><span class="n">FileName_Edit</span><span class="o">.</span><span class="n">ValuePattern</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">media_file</span><span class="p">)</span>

<span class="c">#press the open button</span>
<span class="n">appmap</span><span class="o">.</span><span class="n">wmplayer_Window</span><span class="o">.</span><span class="n">Open_Dialog</span><span class="o">.</span><span class="n">Open_Button</span><span class="o">.</span><span class="n">InvokePattern</span><span class="o">.</span><span class="n">Invoke</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">Run this script as below, and listen the music:</p>
<div class="highlight-python"><div class="highlight"><pre>python script_name.py
</pre></div>
</div>
</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. AXUI introduce</a><ul>
<li><a class="reference internal" href="#axui-philosophy">1.1. AXUI philosophy</a></li>
<li><a class="reference internal" href="#axui-structure">1.2. AXUI structure</a></li>
<li><a class="reference internal" href="#axui-technologies-details">1.3. AXUI technologies details</a><ul>
<li><a class="reference internal" href="#separate-ui-logic-from-test-script">1.3.1. separate UI logic from test script</a></li>
<li><a class="reference internal" href="#plug-in-mechanism-to-extend-support-for-different-ui">1.3.2. plug-in mechanism to extend support for different UI</a></li>
<li><a class="reference internal" href="#other-supports-for-ui-automation">1.3.3. other supports for UI automation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#axui-interface">1.4. AXUI interface</a></li>
<li><a class="reference internal" href="#a-simple-example">1.5. a simple example</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to AXUI document&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="config_AXUI.html"
                        title="next chapter">2. AXUI configurations</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/AXUI_introduce.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="config_AXUI.html" title="2. AXUI configurations"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to AXUI document’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">AXUI document 0.1.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, xcgspring.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b2.
    </div>
  </body>
</html>